# repositories/

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ü–∞–ø–∫–∞ `repositories` —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (–∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏. –≠—Ç–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- **dartz** - –¥–ª—è —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (Either)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞
**repositories/** - üìú –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- repository.dart - üéØ –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- cache_repository.dart - üíæ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- stream_repository.dart - üåä –ü–æ—Ç–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

## –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

### repository.dart
–û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è. –°–æ–¥–µ—Ä–∂–∏—Ç:
- –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
- –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (Either)
- –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –¥–æ–º–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ —Ñ–∞–π–ª–µ:**
- `dartz` - Either, Unit –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### cache_repository.dart
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º. –°–æ–¥–µ—Ä–∂–∏—Ç:
- –ú–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—ç—à–µ–º
- –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –û–ø–µ—Ä–∞—Ü–∏–∏ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫—ç—à–∞

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ —Ñ–∞–π–ª–µ:**
- `dartz` - Either –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤

### stream_repository.dart
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –°–æ–¥–µ—Ä–∂–∏—Ç:
- –ú–µ—Ç–æ–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–µ Stream
- –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –†–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
- –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –¥–ª—è real-time –¥–∞–Ω–Ω—ã—Ö

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ —Ñ–∞–π–ª–µ:**
- `dartz` - Either –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- **–ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è** - –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –æ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –º–æ–∫–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≤ —Ç–µ—Å—Ç–∞—Ö
- **–ì–∏–±–∫–æ—Å—Ç—å** - –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–º–µ–Ω–∞
- **–ß–∏—Å—Ç–æ—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** - domain —Å–ª–æ–π –Ω–µ –∑–Ω–∞–µ—Ç –æ –¥–µ—Ç–∞–ª—è—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **Type-safe** - —Å—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## Best Practices

1. –í—Å–µ –º–µ—Ç–æ–¥—ã –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å Either
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö
3. –û–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ Failure —Ç–∏–ø—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –æ—à–∏–±–æ–∫ –¥–æ–º–µ–Ω–∞
4. –†–∞–∑–¥–µ–ª—è–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Stream –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
6. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤
7. –°–ª–µ–¥–∏—Ç–µ –∑–∞ —á–∏—Å—Ç–æ—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ - –±–µ–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
8. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```dart
// repository.dart
abstract class Repository {
  // CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
  Future<Either<Failure, List<Entity>>> getAll();
  Future<Either<Failure, Entity>> getById(String id);
  Future<Either<Failure, Entity>> create(Entity entity);
  Future<Either<Failure, Entity>> update(Entity entity);
  Future<Either<Failure, Unit>> delete(String id);
  
  // –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–æ–º–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
  Future<Either<Failure, List<Entity>>> search(String query);
  Future<Either<Failure, List<Entity>>> getByCategory(String categoryId);
}

// cache_repository.dart
abstract class CacheRepository {
  // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º
  Future<Either<Failure, Unit>> clearCache();
  Future<Either<Failure, Unit>> refreshCache();
  Future<Either<Failure, bool>> isCacheValid();
  
  // –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏
  Future<Either<Failure, List<Entity>>> getWithCache();
  Future<Either<Failure, Entity>> getByIdWithCache(String id);
}

// stream_repository.dart  
abstract class StreamRepository {
  // –ü–æ—Ç–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
  Stream<Either<Failure, List<Entity>>> watchAll();
  Stream<Either<Failure, Entity>> watchById(String id);
  Stream<Either<Failure, List<Entity>>> watchByCategory(String categoryId);
  
  // –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
  Future<Either<Failure, Unit>> updateStream(Entity entity);
}

// –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
abstract class AuthRepository {
  Future<Either<AuthFailure, UserEntity>> login({
    required String email,
    required String password,
  });
  
  Future<Either<AuthFailure, Unit>> logout();
  Future<Either<AuthFailure, UserEntity>> register({
    required String email,
    required String password,
    required String name,
  });
  
  Future<Either<AuthFailure, bool>> isAuthenticated();
  Stream<UserEntity?> get userStream;
}

// –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
abstract class UserRepository {
  Future<Either<UserFailure, UserEntity>> getCurrentUser();
  Future<Either<UserFailure, UserEntity>> updateProfile(UserEntity user);
  Future<Either<UserFailure, Unit>> changePassword({
    required String currentPassword,
    required String newPassword,
  });
  
  Stream<UserEntity> watchUserProfile(String userId);
}